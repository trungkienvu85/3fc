<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <meta name="viewport" content="width=device-width"/>
    <title>Log</title>
    <link rel="stylesheet" type="text/css" href="../css/styles.css" />
    <link rel="stylesheet" type="text/css" href="../css/mystyle.css" />
    <link rel="stylesheet" type="text/css" href="../css/jquery.mobile-1.3.0.min.css" />
    <script src="../js/jquery-1.9.1.min.js"></script>
    <script src="../js/jquery.mobile-1.3.0.min.js"></script>

    <script src="../js/AppDataContext.js"></script>
    <script src="../js/models/UserModel.js"></script>
    <script src="../js/collections/ApiCollections.js"></script>
    <script src="../js/utils/utils.js"></script>
</head>
<script type="text/javascript">
    $(document).ready(function() {

    });

    function login(){

        console.log("login"+$("#username").val()+$("#password").val());

        var user= new User.UserModel({
            "CountryId":'',
            "CreatedBy":'',
            "CreatedDate":'',
            "FirstName":'',
            "IsActive":'',
            "IsAdmin":'',
            "IsInAu":true,
            "LastName":'',
            "MiddleName":'',
            "Photo":'',
            "PostCode":'',
            "RelationShip":'',
            "School":'',
            "SecretAnswer":'',
            "SecretQuestion":'',
            "StateCode":'',
            "StudentType":'',
            "SuburbLive":'',
            "SuburbSchool":'',
            "UserAge":'',
            "UserEmail":$("#username").val(),
            "UserId":'',
            "UserPassword":$("#password").val(),
            "UserSex":'',
            "UserType":'',
            "YearIn":''
        });
        checkValidateUserLogin(user,function(err){
            if(err==''){
                loginUser(user,function(user,err){

                    if(err==null){

                        console.log('callback:'+user.UserId+'-'+user.gameIds);
                        window.localStorage["UID"] = user.UserId;
                        if(user.UserId=='0'){
                            alert('Error login!');
                        }else{
                            if(user.UserType=='1'||user.UserType=='3'){

                                if(user.gameIds!=null){

                                    location.href= "scoreboard.html";

                                }else{

                                    location.href= "newstep2.html";
                                }

                            }else{

//                        if(user.lisGameSupportedId.length>0){
//
//                            location.href= "scoreboard.html";
//
//                        }else{
//
//                            location.href= "step2.html";
//
//                        }
                            }
                        }

                    }else{

                        alert(err);

                    }

                });

            }else{
                alert(err);
            }
        })
    }

</script>
<body>

<div id="page" data-role="page">

    <fieldset>
        <legend>Login Form</legend>
        <p>
            <label for="username">Username</label><br />
            <input type="text" name="username" value="" id="username" class="ip_form">
        </p>
        <p>
            <label for="password">Password</label><br />
            <input type="password" name="password" value="" id="password" class="ip_form">
        </p>
        <a href="" onclick="login();" data-role="button" data-inline="true">Login</a>
        <a href="" data-role="button" data-inline="true">Cancel</a>
    </fieldset>
</div>

</body>
</html>